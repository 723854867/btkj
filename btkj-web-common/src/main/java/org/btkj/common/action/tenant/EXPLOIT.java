package org.btkj.common.action.tenant;

import java.util.List;

import javax.annotation.Resource;

import org.btkj.common.pojo.info.ExploitInfo;
import org.btkj.common.pojo.param.ExploitParam;
import org.btkj.pojo.entity.user.AppPO;
import org.btkj.pojo.entity.user.EmployeePO;
import org.btkj.pojo.entity.user.TenantPO;
import org.btkj.pojo.entity.user.UserPO;
import org.btkj.pojo.enums.VehicleOrderState;
import org.btkj.pojo.model.Exploit;
import org.btkj.statistics.api.StatisticsService;
import org.btkj.vehicle.api.VehicleService;
import org.btkj.web.util.action.EmployeeAction;
import org.rapid.util.common.message.Result;

/**
 * 业绩
 * 
 * @author ahab
 */
public class EXPLOIT extends EmployeeAction<ExploitParam> {
	
	@Resource
	private VehicleService vehicleService;
	@Resource
	private StatisticsService statisticsService;

	@Override
	protected Result<ExploitInfo> execute(AppPO app, UserPO user, TenantPO tenant, EmployeePO employee, ExploitParam param) {
		int orderNum = (int) vehicleService.orderNum(employee.getId(), param.getBeginTime(), param.getEndTime(), VehicleOrderState.ISSUED.mark());
		List<Exploit> exploits = statisticsService.exploits(employee.getId(), param.getBeginTime(), param.getEndTime(), param.getMod(), param.getTimeType());
		return Result.result(new ExploitInfo(orderNum, exploits));
	}
}
