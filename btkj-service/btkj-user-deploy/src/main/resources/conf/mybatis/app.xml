<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
			"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.btkj.user.persistence.dao.AppDao">
	
	<!-- 
	<select id="searchCount" parameterType="org.btkj.pojo.submit.AppSearcher" resultType="int">
		SELECT COUNT(*) FROM (<include refid="search" />) b
	</select>

	<select id="search" parameterType="org.btkj.pojo.submit.AppSearcher" resultType="org.btkj.pojo.info.AppListInfo" >
		SELECT 
			`id`, 
			`name`, 
			`mobile`, 
			`permit_num`, 
			`created`, 
			`expire_date`, 
			`state`
		FROM
			app 
		<where>
			<if test="null != id">
				id=#{id}
			</if>
			<if test="null != name">
				name=#{name}
			</if>
			<if test="null != mobile">
				AND mobile=#{mobile}
			</if>
			<if test="null != permitNum">
				AND permit_num=#{permitNum}
			</if>
			<if test="null != state">
				AND `state`=#{state}
			</if>
		</where>
		<choose>
			<when test="order == null">
				<choose>
					<when test="null != asc">
						ORDER BY created ASC
					</when>
					<otherwise>
						ORDER BY created DESC
					</otherwise>
				</choose>
			</when>
			<otherwise>
				<choose>
					<when test="order == 'created'">
						<choose>
							<when test="null != asc">
								ORDER BY created ASC
							</when>
							<otherwise>
								ORDER BY created DESC
							</otherwise>
						</choose>
					</when>
					<when test="order == 'expireDate'">
						<choose>
							<when test="null != asc">
								ORDER BY expire_date ASC
							</when>
							<otherwise>
								ORDER BY expire_date DESC
							</otherwise>
						</choose>
					</when>
				</choose>
			</otherwise>
		</choose>
		LIMIT #{start}, #{pageSize}
	</select>  -->
</mapper>